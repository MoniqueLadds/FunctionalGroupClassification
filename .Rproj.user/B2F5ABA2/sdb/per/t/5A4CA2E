{
    "collab_server" : "",
    "contents" : "#run data_prep.R first\n\nlibrary(cluster) #for calculating gower distance\nlibrary(dplyr)   #for cleaning data\n#library(klaR)  #for running kmodes analysis\nlibrary(factoextra)\nlibrary(nomclust)\nlibrary(blockcluster)\nlibrary(data.table)\nlibrary(reshape)\nlibrary(xtable)\nlibrary(mclust)\n\n##Clustering with mixed data types \n  dataSET <- ClusterData\n  distanceMethod <- \"gower\"\n\n#build a similarity/dissimilarity matrix\n  dissMatrix   <- daisy(dataSET, metric = c(distanceMethod), stand = FALSE)\n  #summary(dissMatrix)    \n\n#shows the most similar and most dissimilar pair of observations\n  similar(as.matrix(dissMatrix),dataSET)\n  dissimilar(as.matrix(dissMatrix), dataSET)\n\n#selecting the appropriate number of clusters\n  \n  ##the elbow method\n  #fviz_nbclust(ClusterData_s, hcut, method = \"wss\")\n  \n##Return the sil_width\n  sil_width <- sil_width(as.matrix(dissMatrix))\n  \n    ###Plot it - Change the names of the images\n    plot_silWidth(paste0(distanceMethod,\" distance\"), sil_width)\n    \n    #select number of clusters from sil_width\n    k <- 9\n\n    \n  #heirachical clustering#\n    \n#define options for clustering \n  methodsClust <- c(\"ward.D\", \"ward.D2\", \"single\", \"complete\", \n                    \"average\", \"mcquitty\", \"median\", \"centroid\")\n  \n  ##NULL dataset for the output\n  distance_output <- c(1:k)\n  load(\"data/comparison.RData\")\n  \n  #run through all options for clustering and produce dendograms\n  #and group associations\n  for (i in 1:length(methodsClust)){\n    Cmethod <- methodsClust[i]\n    \n    final_fit <- hclust(dissMatrix, method = Cmethod)\n  \n    ###plot the dendogram\n    clust <- cutree(final_fit,k=k)  # k clusters\n    \n    plotIT <- ggdendPlot(dissMatrix, final_fit, k, clust, dataSET[,1:25])\n    ggsave(paste0(\"documents/figures/dendogram/dist=\",distanceMethod,\",clust=\",Cmethod,\".png\"),plotIT,\n           height = 25, width = 19, units = \"cm\")\n    \n    ##explore the group fits\n    dataSET$groups <- clust\n    setnames(dataSET, \"groups\", Cmethod)\n    \n    \n    hclust_output <- hclust_results(dataSET, 1:25, clust)\n    setnames(hclust_output, \"the_summary\", Cmethod)\n    distance_output <- cbind(distance_output, hclust_output)\n    \n    cor.matrix <- as.matrix(dist(clust,method = \"manhattan\"))\n    m2 <- melt(cor.matrix)[melt(upper.tri(cor.matrix))$value,]\n    m2$value<-ifelse(m2$value==0,1,0)\n    names(m2) <- c(\"c1\", \"c2\", Cmethod)\n    comparison <- merge(comparison,m2,by=c(\"c1\",\"c2\"))\n    }\n\n  save(comparison,file=\"output/gowerDist_comparison.RData\")\n  save(distance_output,file = \"output/distance_ouptut.RData\")\n  \n  \n  ##analyse and interpret output\n\nload(\"output/gowerDist_comparison.RData\")  \n  \ncomparison$sum <- rowSums(comparison[,3:10])/8\nhist(comparison$sum)\n  \ncomparison[comparison$sum>0.8,1:2]\n\n#adjusted Rand index\n#randIndexij <- function(dat, )\n\nn <- ncol(comparison[,3:10])\n\nrandIndex <- matrix(0,n,n)\n\nfor ( i in 1:n)\n{\n  for (j in i:n)\n  {\n    randIndex[i,j] <- adjustedRandIndex(randIndexij[,i],randIndexij[,j])\n  }\n}\n\n#randIndex[upper.tri(randIndex)] <- t(randIndex)[lower.tri(randIndex)]\n\nrandIndex <- data.frame(randIndex, row.names = methodsClust)\ncolnames(randIndex) <- methodsClust\n\nrandIndexij <- xtable(randIndex, digits = 3,\n                      caption = \"Adjusted rand index value indicating \n                      similarity between clustering methods\")\n#randIndexij <-  printbold(randIndexij, randIndexij>0.6&randIndexij<1)\nprint(randIndexij, file = \"documents/tables/randIndex.tex\")\n",
    "created" : 1495519207022.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1879842241",
    "id" : "5A4CA2E",
    "lastKnownWriteTime" : 1495566517,
    "last_content_update" : 1495566517263,
    "path" : "C:/Users/miree/OneDrive/OneDrive - Victoria University of Wellington - STAFF/TropicGroupClassification/R/cluster_analysis.R",
    "project_path" : "R/cluster_analysis.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}